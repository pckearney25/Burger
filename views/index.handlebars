<h1>Eat-Da-Burger!</h1>

<img src="/assets/img/burger.jpg" alt="Burger pic">

<h2>Burgers I want to eat:</h2>

<ol>
    {{#each burgers}} {{#unless devoured}}
    <li>
        <span>{{this.burger_name}} (database ID: {{this.id}})</span>
        <button class="devour-it" data-id="{{this.id}}">Eat me!</button>
    </li>
    {{/unless}} {{/each}}
</ol>

<h2>Burgers I've eaten: </h2>

<ol>
    {{#each burgers}} {{#if devoured}}
    <li>
        <span>{{this.burger_name}} (database ID: {{this.id}})</span>
    </li>
    {{/if}} {{/each}}
</ol>

<h2>New Burger to Try:</h2>
<form class="create-form">

    <div class="form-group">
        <label for="new-burger">Burger Name:</label>
        <input type="text" id="new-burger" name="name">
    </div>

    <button type="submit">Add Burger</button>
</form>

<script>
    $(function () {

        $(".create-form").on("submit", function (event) {
            // Make sure to preventDefault on a submit event.
            event.preventDefault();

            var newBurger = {
                name: $("#new-burger").val().trim(),
            };

            // Send the POST request.
            $.ajax("/api/burgers", {
                type: "POST",
                data: newBurger
            }).then(
                function () {
                    console.log("Added a new burger!");
                    // Reload the page to get the updated list
                    location.reload();
                }
            );
        });

        $(".devour-it").on("click", function (event) {
            var id = $(this).data("id");
            console.log(id);

            var updateBurger = {
                devoured: true
            };

            // Send the PUT request.
            $.ajax("/api/burgers/" + id, {
                type: "PUT",
                data: updateBurger
            }).then(
                function () {
                    console.log("I ate it!");
                    // Reload the page to get the updated list
                    location.reload();
                }
            );
        });
    });


</script>